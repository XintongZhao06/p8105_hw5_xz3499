---
title: "p8105_mtp_xz3499"
author: "Xintong Zhao"
date: "`r Sys.Date()`"
output: github_document
---

```{r, echo=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,           
  warning = FALSE,       
  message = FALSE           
)
```

```{r}
library(tidyverse)
library(ggplot2)
library(broom)
```

## Problem 1
```{r}
check_duplicate_birthdays <- function(n) {
  birthdays <- sample(1:365, size = n, replace = TRUE)
  repeated_bday = length(unique(birthdays)) < n
  repeated_bday
}

set.seed(123)

birthday_sim_results <- expand_grid(
  group_size = 2:50,
  iteration = 1:10000
) %>%
  mutate(
    has_duplicate = map_lgl(group_size, check_duplicate_birthdays)
  ) %>%
  group_by(group_size) %>%
  summarize(
    prob_duplicate = mean(has_duplicate)
  )

birthday_plot <- birthday_sim_results %>%
  ggplot(aes(x = group_size, y = prob_duplicate)) +
  geom_line(color = "steelblue", size = 1) +
  geom_point(color = "steelblue", size = 1) +
  labs(
    title = "Probability of Shared Birthday by Group Size",
    x = "Number of People in Group",
    y = "Probability of at Least One Shared Birthday",
    caption = "Based on 10,000 simulations per group size"
  ) +
  theme_minimal() +
  scale_y_continuous(labels = scales::percent_format()) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    panel.grid.minor = element_blank()
  )

birthday_plot
```

Comment:

The probability curve grows rapidly in an S shape. When the number of people in a group is 23, the probability exceeds 50%. When the number of people in a group is around 40, the probability exceeds 90%. This goes against our intuition that 183 people are needed to have a 50% chance. This is because as the number of people increases, the possible number of birthday pairings grows exponentially, causing the probability of repetition to increase rapidly.

## Problem 2

```{r}

```

